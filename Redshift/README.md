# Redshift

- MPP
 - 1つのタスクを複数のノードで分散して実行する仕組み
 - Redshiftではリーダーノードがタスクをコンピュートノードに分散して実行する
 - ノードを追加する(スケールアウト)でパフォーマンス向上可能
 
- シェアードナッシング
 - ディスクをノードで共有しない構成
 - ディスクを共有するとノード数が増えた時にボトルネックになるために回避する
 - ノードとディスクのセットが増えていく

- スライス
 - メモリとディスクをノード内で分割した理論的な処理単位
 
- Leaderノード
 - SQLをコンパイルしてコードを生成し、コンピュートノードへ配信
 
- コンピュートノードの追加でパフォーマンス向上(スケールアウト)
 
- ノードタイプ
 - SSDベースDCとHDDベースのDSから選択
 - 最大100ノードで1.6PByteまで拡張可能
 
- リーダーノードと 利用費用
 - リーダーノード分は利用費用が不要
 - 1ノード構成にした場合、リーダノードとコンピュートノードが1ノードに同居する
 
- I/Oを削減する
 - 列指向型(カラムナ)
 - 行指向型は他のRDBMS
 - 圧縮
  - データは圧縮してストレージに格納される
  - カラムナのため類似したデータが集まり、高い圧縮率
  - COPYコマンドでANALYZEコマンドで圧縮アルゴリズムの推奨を得ることが可能
  - Redshiftはブロック単位でディスクにデータを格納 1ブロック = 1MB
  - ブロック内の最小値と最大値をメモリに保存
  - 不要なブロックを読み飛ばすことが可能
 
- フルマネージドサービス
 - 設計、構築、運用の手間を削減
 - 数クリックで起動
 - ノード数やタイプは後から変更可能
 - バックアップ(Snapshot)やモニタリング機能を内蔵
 - パッチ適用も自動的
  - メンテナンスウインドウでパッチの時間帯を指定可能

- Redshiftが向く用途
 - 特化型のデータベースのため、適した用途に使うことでパフォーマンスを発揮する
 
- Redshiftに向くワークロード
 - 巨大なデータセット(数百GB - ペタバイト)
 - 1つ1つのSQLが複雑だが、同時実行SQLは少ない
 - データ更新は一括導入
 
- ユースケース
 - データウェアハウス
 - ユーザがクエリを生成する

- Redshiftの特徴を生かせないユースケース
 - SQLの並列実行数が多い
 - きわめて短いレイテンシーが必要なケース
 - ランダムかつパラレルな更新アクセス
 - 巨大なデータを格納するが集計等はしない
 
- 各ノードのデータサイズが著しく異なるとパフォーマンスに影響がでる
- データの転送を最小限にする

 
 
