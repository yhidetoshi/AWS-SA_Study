# CloudFormation

- CloudFormation
 - スタック
  - テンプレートからプロビジョニングされるリソースの集合のことをスタックと呼ぶ
  - スタック単位でリソースの管理が可能
  - スタックに 紐づくリソースを破棄することが可能
  - 使用するリソースおよび、リソース構築順はテンプレート依存関係からCloudFormationが自動的に決定
 - これらを一度に生成、破棄することが可能
 
- テンプレート
  - JSON形式、YAML形式のテキストが対応
  - パラメータの定義
  - リソースの作成
 
- フレームワーク
 - スタックの作成
 - スタックの更新
 - エラー検知とロールバック
  
- テンプレートとスニペットは公開されている

- Serverless Application Model(SAM)
 - CloudFormationでネイティブにサポートされている構文を使用して、サーバレスアプリケーションとしてなサービスである、
 　　　　Lambda, API-Gateway, DynamoDBを簡単に定義可能
 - 利用にはCloudFormationにてサーバレスアプリケーションの宣言を行う
   -> CloudFormationのテンプレート内にサーバレスアプリケーションを定義していることを通知する。

- テンプレート
 - スタック構成図の設計図
  - どのリソースをどう起動するかなどを記述
 - Resourceの依存関係はCloudFormationが自動判別
 - JSON/YAMLフォーマットで記述
 
- Resource
 - EC2やELB, RDSなどを起動するサービスを指定
 - リソースごとに決められたプロパティを設定する
 - CloudFormationで利用可能なリソースタイプは現在42サービス、173リソース。
 
- Parameters
 - スタック構築時に値を定義することができる
 - データ型、デフォルト値、最大値、最小値など型が設定可能
 
- Function
 - パラメータの参照やMapの参照などの際はFunctionを利用する
 - Parameterの取得に利用したRefもFunctionのひとつ
 - 大別して10種類が用意されている
 
- 類似 パラメータ参照
 - あらかじめ定義された擬似パラメータ群で Ref により参照できる
 - 利用可能なパラメータは下記の通り
  - AWS::Region
  - AWS::AccountId
  -　など
 
- Mapping
 - キーと値のマッピングテーブルを管理できる
 - リージョンやユーザ入力パラーメタによって値が変わるものに利用
 - Mappingsを利用することでテンプレートの再利用が可能
 
- Conditions
 - Resourceで Condition を指定すると、指定した条件が成立しているか場合に限り、そのリソースが起動されるようになる。
 
 
 
